<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_script_include">
    <sys_script_include action="INSERT_OR_UPDATE">
        <access>package_private</access>
        <active>true</active>
        <api_name>x_813980_charge_0.ChargerClientScripts</api_name>
        <caller_access/>
        <client_callable>true</client_callable>
        <description/>
        <name>ChargerClientScripts</name>
        <script><![CDATA[var ChargerClientScripts = Class.create();
ChargerClientScripts.prototype = Object.extendsObject(global.AbstractAjaxProcessor, {
	getDriverFromUser:function(user_id){
		var gr = new GlideRecord("x_813980_charge_0_driver");
		var currentUserDriver = gr.get("user",user_id);
		return gr.getValue('sys_id');
	},
	getPrimaryVehicleFromUser:function(user_id){
		var user = this.getDriverFromUser(user_id);
		var gr = new GlideRecord("x_813980_charge_0_vehicle");
		gr.addQuery("driver",user);
		gr.addActiveQuery();
		gr.addQuery("primary_vehicle",true);
		gr.query();
		if(gr.next()){	
				return gr.getValue('sys_id');
		} else{
			return;
		}
	},
	getChargersFromLocation:function(location){
		gs.info("Location:"+location);
		var arr = [];
		var gr = new GlideRecord("x_813980_charge_0_charger");
		gr.addQuery("location",location);
		gr.addActiveQuery();
		gr.query();
		while(gr.next()){
			arr.push(gr.getValue("sys_id"));
		}		
		gs.info(arr);
		return "sys_idIN"+arr.join(',');
	},
	getPrimaryChargerFromUser:function(user_id){
		var gr = new GlideRecord("x_813980_charge_0_driver");
		var currentUserDriver = gr.get("user",user_id);
		var location = gr.getValue("primary_location");
		if(location!==""){
			return location;
// 			var loc = new GlideRecord("x_813980_charge_0_location");
// 			loc.get("sys_id",location);
// 			return loc.getValue("sys_id");
		}
		
	},
	addDurationToStart:function(){
		var start = this.getParameter('sysparm_start');
		var duration = this.getParameter('sysparm_duration');
		var dur = new GlideDuration(duration);		
		var gdt = new GlideDateTime(start);
		var durNum = dur.getNumericValue();
		gdt.add(durNum);
		return gdt.getValue();
	},
    type: 'ChargerClientScripts'
});]]></script>
        <sys_class_name>sys_script_include</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2022-12-29 18:01:37</sys_created_on>
        <sys_id>42d9c84a2fc861102a6d41e72799b638</sys_id>
        <sys_name>ChargerClientScripts</sys_name>
        <sys_package display_value="Charge At Work" source="x_813980_charge_0">199366612fc421102a6d41e72799b626</sys_package>
        <sys_policy>read</sys_policy>
        <sys_scope display_value="Charge At Work">199366612fc421102a6d41e72799b626</sys_scope>
        <sys_update_name>sys_script_include_42d9c84a2fc861102a6d41e72799b638</sys_update_name>
    </sys_script_include>
</record_update>
