<?xml version="1.0" encoding="UTF-8"?><record_update table="sp_widget">
    <sp_widget action="INSERT_OR_UPDATE">
        <category>custom</category>
        <client_script><![CDATA[api.controller=function($scope,spModal) {
  /* widget controller */
  var c = this;

	c.cancelModal = function(){
		$scope.$parent.$parent.$dismiss();

	}

  c.action = function(action){
	if(action == 'charge'){
		c.cancelModal();
		spModal.open({
			"widget" : "sc-input-wrapper",
			"widgetInput" : {
				sys_id: c.data.constants.CAT_ITEM_NEW_SESSION,
				"display_cart_on_right": "false",
				"auto_redirect": false,
				passed_fields: c.data.new_session,
				embedded: true
			},
			"buttons":[],
		});
	}
	if(action == 'update'){
		c.cancelModal();
		spModal.open({
			"widget" : "sc-input-wrapper",
			"widgetInput" : {
				sys_id: c.data.constants.CAT_ITEM_REPORT_INFO,
				"display_cart_on_right": "false",
				"auto_redirect": false,
				passed_fields: c.data.update_session,
				embedded: true
			},
			"buttons":[],
		});
	}
  };
};]]></client_script>
        <controller_as>c</controller_as>
        <css>.charger-details-container {&#13;
	align-items: center;&#13;
    justify-content: center;&#13;
	display: flex;&#13;
}&#13;
&#13;
.charger-details-controls button {&#13;
	margin: 1rem 0;&#13;
}</css>
        <data_table>sp_instance</data_table>
        <demo_data/>
        <description/>
        <docs/>
        <field_list/>
        <has_preview>false</has_preview>
        <id>charger-details</id>
        <internal>false</internal>
        <link><![CDATA[function link(scope, element, attrs, controller) {
  
}]]></link>
        <name>Charger Details</name>
        <option_schema/>
        <public>false</public>
        <roles>x_snc_charger.user</roles>
        <script><![CDATA[(function() {
  /* populate the 'data' object */
  /* e.g., data.table = $sp.getValue('table'); */
  data.charger = '';
  if(input){
	data.charger = input.charger_id;
  }
  var cu = new ChargerUtils();
  data.constants = cu.getConstants();
  const {TABLE_CHARGERS,TABLE_QUEUE,CAT_ITEM_NEW_SESSION} = data.constants;
 

  var chargeGR = new GlideRecord(TABLE_CHARGERS);
  chargeGR.get(data.charger);
  if(chargeGR){
	console.log(chargeGR.getValue('state'));
  }

	var _options = {charger_id:data.charger};
	data.widget = $sp.getWidget("charger-card",_options);

	data.new_session = {
			values:
			[
				{
					fieldName:'charger',
					fieldValue:data.charger,
					enforced:true}
			]
		};
		data.update_session = data.new_session;
		data.update_session.values.push(
			{
				fieldName:'state',
				fieldValue:chargeGR.getValue('state'),
				enforced:false,
			}
		);


})();]]></script>
        <servicenow>false</servicenow>
        <sys_class_name>sp_widget</sys_class_name>
        <sys_created_by>aaron.brunet</sys_created_by>
        <sys_created_on>2024-03-30 20:17:26</sys_created_on>
        <sys_id>dc48c68dc3958a1079ff4445990131bc</sys_id>
        <sys_mod_count>24</sys_mod_count>
        <sys_name>Charger Details</sys_name>
        <sys_package display_value="Charger" source="x_snc_charger">7a4ce69387e04a106e4b11f83cbb3517</sys_package>
        <sys_policy/>
        <sys_scope display_value="Charger">7a4ce69387e04a106e4b11f83cbb3517</sys_scope>
        <sys_update_name>sp_widget_dc48c68dc3958a1079ff4445990131bc</sys_update_name>
        <sys_updated_by>aaron.brunet</sys_updated_by>
        <sys_updated_on>2024-03-31 17:54:03</sys_updated_on>
        <template><![CDATA[<div class="charger-details-container row charger-widget">
	<sp-widget widget="data.widget"></sp-widget>
  <div class="charger-details-controls column">
    <button class="btn btn-primary" ng-click="c.action('charge')">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 48 48" height="48" width="48" id="Flash-1--Streamline-Plump"><desc>Flash 1 Streamline Icon: https://streamlinehq.com</desc><g id="flash-1--flash-power-connect-charge-electricity-lightning"><path id="Union" fill="#1aeaac" d="M31.0468 0.731C27.2447 0.5129 20.7577 0.2866 14.362 0.7538C12.2385 0.9095 10.3976 2.2818 9.6421 4.2725C6.4172 12.7488 4.8806 20.5669 4.2255 24.7095C3.8154 27.3083 5.7039 29.6257 8.3017 29.8032C10.5215 29.9559 13.7826 30.1147 17.5889 30.094C17.184 33.3884 16.7614 37.7843 16.3409 42.5126C15.9661 46.7487 21.0598 49.2955 24.0915 46.0468C31.8753 37.7065 39.0113 28.4317 42.9235 23.1459C45.0768 20.2388 43.1809 16.1709 39.5045 16.0754C37.4318 16.0233 35.3585 16.007 33.2853 16.0266C34.009 12.8724 34.6631 9.4451 35.2642 6.1372C35.7522 3.4512 33.8283 0.8908 31.0468 0.731Z" stroke-width="1"></path></g></svg> 
      Start Charge</button>
    <button class="btn btn-secondary" ng-click="c.action('update')">
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 48 48" id="Pencil-Square--Streamline-Plump"><desc>Pencil Square Streamline Icon: https://streamlinehq.com</desc><g id="pencil-square--change-document-edit-modify-paper-pencil-write-writing"><path id="Rectangle 1098" fill="#2859c5" d="M44.42 14.557c1.546 -1.546 2.146 -3.798 0.937 -5.62 -0.655 -0.986 -1.574 -2.156 -2.856 -3.438 -1.282 -1.282 -2.452 -2.201 -3.438 -2.856 -1.822 -1.21 -4.074 -0.61 -5.62 0.937L16.198 20.825c-0.578 0.578 -0.974 1.312 -1.053 2.126 -0.133 1.381 -0.256 3.962 0.024 7.967a2.063 2.063 0 0 0 1.913 1.913c4.005 0.28 6.586 0.157 7.967 0.024 0.814 -0.079 1.548 -0.475 2.126 -1.053L44.42 14.557Z" stroke-width="1"></path><path id="Subtract" fill="#1aeaac" d="m29.206 3.574 -15.13 15.13c-0.982 0.982 -1.76 2.337 -1.917 3.958 -0.15 1.562 -0.273 4.31 0.018 8.465a5.063 5.063 0 0 0 4.695 4.696c4.156 0.29 6.904 0.169 8.465 0.018 1.622 -0.157 2.977 -0.935 3.96 -1.918l15.129 -15.13c0.046 1.854 0.074 3.92 0.074 6.207 0 6.899 -0.254 11.783 -0.502 14.91 -0.261 3.291 -2.797 5.827 -6.087 6.088 -3.128 0.248 -8.012 0.502 -14.911 0.502 -6.899 0 -11.783 -0.254 -14.91 -0.502 -3.291 -0.261 -5.827 -2.797 -6.088 -6.087C1.754 36.782 1.5 31.898 1.5 25c0 -6.899 0.254 -11.783 0.502 -14.91 0.261 -3.291 2.797 -5.827 6.087 -6.088C11.217 3.754 16.101 3.5 23 3.5c2.287 0 4.352 0.028 6.206 0.074Z" stroke-width="1"></path><path id="Intersect" fill="#1aeaac" d="M43.775 15.202c-1.083 -1.72 -2.654 -3.79 -4.92 -6.057 -2.267 -2.266 -4.337 -3.838 -6.057 -4.92L29.15 7.873c1.516 0.84 3.668 2.307 6.169 4.808 2.5 2.5 3.967 4.653 4.808 6.169l3.648 -3.648Z" stroke-width="1"></path></g></svg>
      Update Status</button>
  </div>
</div>]]></template>
    </sp_widget>
</record_update>
